apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: payment-cpu-stress
  namespace: default
  annotations:
    chaos-mesh.org/purpose: "Test behavior under CPU pressure and HPA scaling"
spec:
  mode: one
  selector:
    namespaces:
      - default
    labelSelectors:
      'app': 'payment-gateway'
  stressors:
    cpu:
      workers: 2
      load: 80
  duration: '5m'
---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: auth-service-cpu-spike
  namespace: default
  annotations:
    chaos-mesh.org/purpose: "Simulate CPU spike during authentication load"
spec:
  mode: all
  selector:
    namespaces:
      - default
    labelSelectors:
      'app': 'auth-service'
  stressors:
    cpu:
      workers: 4
      load: 95
  duration: '2m'
---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: phi-service-memory-stress
  namespace: default
  annotations:
    chaos-mesh.org/purpose: "Test memory limits and OOM handling for PHI encryption"
spec:
  mode: one
  selector:
    namespaces:
      - default
    labelSelectors:
      'app': 'phi-service'
  stressors:
    memory:
      workers: 1
      size: '256MB'
  duration: '3m'
---
apiVersion: chaos-mesh.org/v1alpha1
kind: StressChaos
metadata:
  name: combined-stress-test
  namespace: default
  annotations:
    chaos-mesh.org/purpose: "Combined CPU and memory stress test"
    chaos-mesh.org/severity: "high"
spec:
  mode: one
  selector:
    namespaces:
      - default
    labelSelectors:
      'tier': 'backend'
  stressors:
    cpu:
      workers: 2
      load: 70
    memory:
      workers: 1
      size: '128MB'
  duration: '4m'
